/*
 * YaST2: Modules testsuite
 *
 * Description:
 *   Testsuite for the security module
 *
 * Authors:
 *   Michal Svec <msvec@suse.cz>
 *
 * $Id$
 */

{

include "testsuite.ycp";
import "Security";

map scr_info = $[
    "sysconfig" : $[
	"security" : $[
	    "PERMISSION_SECURITY"	:	"paranoid",
	],
	"suseconfig" : $[
	    "CWD_IN_ROOT_PATH"		:	"r2",
	    "CWD_IN_USER_PATH"		:	"r3",
	],
	"displaymanager" : $[
	    "KDM_SHUTDOWN"		:	"r3",
	    "DISPLAYMANAGER_REMOTE_ACCESS" :	"r9",
	],
	"locate" : $[
	    "RUN_UPDATEDB_AS"		:	"r7",
	],
    ],
    "etc" : $[
	"login_defs" : $[
	    "FAILLOG_ENAB"		:	"l1",
	    "FAIL_DELAY"		:	"l2",
	    "GID_MAX"			:	"l3",
	    "GID_MIN"			:	"l4",
	    "LASTLOG_ENAB"		:	"l5",
	    "OBSCURE_CHECKS_ENAB"	:	"l6",
	    "PASS_MAX_DAYS"		:	"l7",
	    "PASS_MAX_LEN"		:	"l8",
	    "PASS_MIN_DAYS"		:	"l9",
	    "PASS_MIN_LEN"		:	"l10",
	    "PASS_WARN_AGE"		:	"l11",
	    "UID_MAX"			:	"l12",
	    "UID_MIN"			:	"l13"
	],
	"inittab" : $[
	    "ca"			:	":ctrlaltdel:/sbin/shutdown -r -t 4 now"
	]
    ],
    "target" : $[ "size" : 1 ],
    "pam" : $[ "passwd" : $[ "password" : $[
	"pam_unix" : [
	    $[ "arguments" : "nullok use_first_pass md5 use_authtok" ]
	]
    ]]]
];

TEST(``(Security::Read()),[scr_info],nil);

}
